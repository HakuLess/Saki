# MITMProxy 配置说明

## 安装 MITMProxy

### Windows 安装

1. **使用 pip 安装（推荐）**:
   ```bash
   pip install mitmproxy
   ```

2. **或者从官网下载**:
   - 访问 [mitmproxy.org](https://mitmproxy.org/)
   - 下载 Windows 版本并安装

### 验证安装

安装完成后，在命令行中运行以下命令验证:
```bash
mitmdump --version
```

如果显示版本信息，说明安装成功。

## 配置 MITMProxy

### 1. 生成证书

首次运行时，mitmproxy 会自动生成证书。你可以通过以下命令手动触发:
```bash
mitmdump -q
```
运行几秒钟后按 `Ctrl+C` 停止。

### 2. 安装证书到系统

mitmproxy 会自动尝试安装证书。如果自动安装失败，你可以手动安装:

1. 证书文件通常位于:
   - Windows: `%USERPROFILE%\.mitmproxy\mitmproxy-ca-cert.cer`

2. 手动安装步骤:
   - 双击证书文件
   - 选择"本地计算机"
   - 选择"将所有的证书都放入下列存储"
   - 选择"受信任的根证书颁发机构"
   - 完成安装

### 3. 配置雀魂客户端

1. 打开雀魂客户端
2. 进入设置 -> 网络设置
3. 配置代理:
   - 代理服务器: localhost
   - 端口: 10999 (默认端口)

## 常见问题解决

### 1. "系统找不到指定的文件" 错误

这个错误表示系统找不到 `mitmdump` 命令。解决方法:

1. 确保 mitmproxy 已正确安装
2. 确保 mitmproxy 在系统 PATH 中
3. 重启命令行或 IDE

### 2. 证书安装失败

如果证书安装失败:

1. 手动安装证书到"受信任的根证书颁发机构"
2. 确保以管理员权限运行安装命令
3. 检查杀毒软件是否阻止了证书安装

### 3. 无法拦截网络流量

如果无法拦截网络流量:

1. 确保雀魂客户端已正确配置代理
2. 确保端口 10999 未被其他程序占用
3. 检查防火墙设置

## 开发调试

### 查看日志

应用程序会输出详细的日志信息，包括:
- 网络拦截状态
- 消息处理过程
- 错误信息

### 测试拦截

你可以使用以下命令测试 mitmproxy 是否正常工作:
```bash
curl -x localhost:10999 https://httpbin.org/get
```

这会通过代理发送请求，你可以在 mitmproxy 的输出中看到请求信息。